### README.md

# Проект по мониторингу и анализу данных ЭКГ

## Описание

Этот проект предназначен для мониторинга, записи и анализа данных ЭКГ. Он включает в себя три основных компонента:

1. **SerialReader** - Класс для работы с серийным портом.
2. **StressIndexCalculator** - Класс для анализа данных ЭКГ и вычисления индекса напряжения.
3. **Графический интерфейс (GUI)** - Окно для взаимодействия с пользователем.

### Установка

1. Установите необходимые зависимости:
    ```bash
    pip install pyserial numpy
    ```
2. Склонируйте репозиторий:
    ```bash
    git clone https://github.com/VoKi21/ArduinoEcg
    ```
3. Запустите программу:
    ```bash
    python ArduinoEcg/serial_plotter.py
    ```

## Использование

### SerialReader

Класс `SerialReader` используется для чтения данных из серийного порта и записи этих данных.

#### Методы:

- **start_serial(port: str) -> bool**: Открывает серийный порт для чтения данных.
  - `port`: Название серийного порта (например, '/dev/ttyACM0').
  - Возвращает `True`, если порт успешно открыт, иначе `False`.

- **kill_serial() -> None**: Закрывает серийный порт и завершает поток чтения.

- **start_recording() -> bool**: Начинает запись данных в массив.
  - Возвращает `True`, если запись успешно начата, иначе `False`.

- **stop_recording() -> list**: Останавливает запись данных и возвращает записанные данные.
  - Возвращает список записанных данных в формате `[(timestamp, reading), ...]`.

### StressIndexCalculator

Класс `StressIndexCalculator` используется для анализа данных ЭКГ и вычисления индекса напряжения.

#### Свойства:

- **peaks**: Возвращает список пиков (R-зубцов) в данных ЭКГ.
- **rr_intervals**: Возвращает массив RR интервалов и соответствующих временных меток.
- **processed_rr_intervals**: Возвращает массив обработанных RR интервалов, очищенных от выбросов.
- **count_of_intervals**: Возвращает количество RR интервалов.
- **min_rr**: Возвращает минимальное значение RR интервала.
- **max_rr**: Возвращает максимальное значение RR интервала.
- **range**: Возвращает диапазон RR интервалов.
- **groups**: Возвращает список 10 групп RR интервалов.
- **longest_group**: Возвращает группу с наибольшим количеством RR интервалов.
- **length_of_longest**: Возвращает длину группы с наибольшим количеством RR интервалов.
- **mo**: Возвращает моду (Мо) RR интервалов.
- **amo**: Возвращает амплитуду (АМо) RR интервалов.
- **stress_index**: Возвращает индекс напряжения (stress index).

#### Методы:

- **find_peaks(threshold: float) -> list**: Находит пики (R-зубцы) в данных ЭКГ.
  - `threshold`: Пороговое значение для поиска пиков.
  - Возвращает список индексов пиков.

### Дополнительные функции

- **trim_cache_time(cache: list, time_len: float, destination: float) -> list**: Обрезает кеш данных до указанной длины времени.
  - `cache`: Кеш данных в формате `[(timestamp, value), ...]`.
  - `time_len`: Текущая длина времени кеша.
  - `destination`: Желаемая длина времени кеша.
  - Возвращает обрезанный кеш данных.

- **read_csv(file_path: str) -> tuple**: Читает данные из CSV файла.
  - `file_path`: Путь к CSV файлу.
  - Возвращает списки временных меток и значений ЭКГ.

- **read_list(ecg: list) -> tuple**: Читает данные из списка.
  - `ecg`: Список данных ЭКГ в формате `[(timestamp, value), ...]`.
  - Возвращает списки временных меток и значений ЭКГ.

- **remove_outstanding_intervals(intervals: list) -> np.array**: Удаляет выбросы из массива RR интервалов.
  - `intervals`: Массив RR интервалов.
  - Возвращает отсортированный по возрастанию массив RR интервалов без выбросов.

## Пример использования

Пример использования классов для чтения и анализа данных ЭКГ:

```python
from serial_reader import SerialReader
from stress_index_calculator import StressIndexCalculator

# Инициализация и запуск чтения данных из серийного порта
serial_reader = SerialReader()
if serial_reader.start_serial('/dev/ttyACM0'):
    print("Серийный порт открыт")
    serial_reader.start_recording()

# Через некоторое время остановка записи данных
data = serial_reader.stop_recording()
serial_reader.kill_serial()

# Анализ записанных данных
calculator = StressIndexCalculator(ecg=data)
print(f"Индекс стресса: {calculator.stress_index}")
```
